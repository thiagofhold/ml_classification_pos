
##setting work directory
setwd("~/Desktop/projeto_fred_fmu/ml_classification_pos/forest_firing/bases")

install.packages("ggplot2")
install.packages("lattice")

##importando dataset e atribuindo numa variavel
amazon_f <- read.csv("fires_trt.csv",sep = ",")

##checking the structure of the dataset
str(amazon_f)
summary(amazon_f)
head(amazon_f)
colnames(amazon_f)

# Data Partition
set.seed(123)
# especifica que queremos 2 grupos utilisando a funcao sample "c" specifies the way we want the 2 groups to be devided.
ind <- sample(2, nrow(amazon_f), replace = TRUE, prob = c(0.7, 0.3))
train <- amazon_f[ind==1,]
test <- amazon_f[ind==2,]

#modelos de classificacao

#Naive Bayes 
library(e1071)
fit_nb <- naiveBayes(trt_number ~ ., data = train)

# K-Nearest Neighbors

library(caret)
# fit_knn1 <- knn3(trt_number ~ ., data = train, k = 100)

fit_knn10 <- knn3(trt_number ~ ., data = train, k = 10)


library(randomForest)
fit_rf <- randomForest(trt_number ~ ., data = train)


# Predictions 

# NaiveBayes
pred_nb <- predict(fit_nb , test, type = 'raw')[,2]

# KNN
# pred_knn1 <- predict(fit_knn1 , test, type = 'prob')
pred_knn10 <- predict(fit_knn10 , test, type = 'prob')[,2]

# Random forest
pred_rf <- predict(fit_rf , test, type = 'prob')[,2]


# confusion Matrix
caret::confusionMatrix(pred_nb, test$trt_number, positive = '1')


library(ROCit)
# plot(rocit(score=pred_knn1,class=test$trt_number))
plot(rocit(score=pred_knn10,class=test$trt_number))
plot(rocit(score=pred_nb,class=test$trt_number))
